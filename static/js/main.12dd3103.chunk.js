(this.webpackJsonpprismatic=this.webpackJsonpprismatic||[]).push([[0],{30:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n(0),o=n.n(i),r=n(11),s=n.n(r),c=(n(30),n(10)),u=n(2),l=n(3),p=n(12),h=n(4),f=n(9),d=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).onFileChange=function(t){e.props.loadProjectFile(t.target.files[0])},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)("input",{type:"file",id:"projectFilePicker",name:"projectFile",accept:".zip",onChange:this.onFileChange})})}}]),n}(i.Component),v=n(8),F=n.n(v),y=n(6),g=n(14),b=function(){function e(t,n,a,i,o){var r=this;Object(u.a)(this,e),this.keyLED=void 0,this.id=void 0,this.id_str=void 0,this.repeat=1,this.end=!1,this.activeThread=-1,this.nextID=0,this.canvas=void 0,this.currentOn=[],this.lastEventTime=void 0,this.activeList=void 0,this.play=Object(g.a)(F.a.mark((function e(){var t,n,a,i,o,s,u,l,p,h,f,d,v,y;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r.activeList[r.id_str]&&(r.activeList[r.id_str]=r.id),t=r.getID(),r.activeThread=t,r.currentOn=[],n=0,r.end=!1,r.lastEventTime=Date.now();case 7:if(!(0===r.repeat||n++<r.repeat)){e.next=54;break}a=Object(c.a)(r.keyLED),e.prev=9,a.s();case 11:if((i=a.n()).done){e.next=41;break}if(o=(o=i.value).trim(),r.activeThread==t){e.next=16;break}return e.abrupt("return");case 16:if(""!=o){e.next=18;break}return e.abrupt("continue",39);case 18:s=o.split(" "),e.t0=s[0],e.next="o"===e.t0||"on"===e.t0?22:"f"===e.t0||"off"===e.t0?29:"d"===e.t0||"delay"===e.t0?36:39;break;case 22:return"*"===s[1]&&(s[1]="mc"),"mc"===s[1]||"l"===s[1]?(u=[s[1],parseInt(s[2]-1)],f=u[0],d=u[1]):NaN!==parseInt(s[1])&&(l=[parseInt(s[2]-1),parseInt(s[1]-1)],f=l[0],d=l[1]),p="a"===s[s.length-2]||"auto"===s[s.length-2]?parseInt(s[s.length-1]):"#"+s[s.length-1],r.canvas.setColor(f,d,p),h=f+"-"+d,void 0===r.currentOn[h]?r.currentOn[h]=[f,d]:0===p&&delete r.currentOn[h],e.abrupt("break",39);case 29:return f=void 0,d=void 0,"*"===s[1]&&(s[1]="mc"),"mc"===s[1]||"l"===s[1]?(v=[s[1],parseInt(s[2]-1)],f=v[0],d=v[1]):NaN!==parseInt(s[1])&&(y=[parseInt(s[2]-1),parseInt(s[1]-1)],f=y[0],d=y[1]),r.canvas.setColor(f,d,0),h=f+"-"+d,delete r.currentOn[h],e.abrupt("break",39);case 36:return e.next=38,r.wait(parseInt(s[1]));case 38:return e.abrupt("break",39);case 39:e.next=11;break;case 41:e.next=46;break;case 43:e.prev=43,e.t1=e.catch(9),a.e(e.t1);case 46:return e.prev=46,a.f(),e.finish(46);case 49:if(!r.end){e.next=52;break}return r.stop(),e.abrupt("break",54);case 52:e.next=7;break;case 54:r.activeThread==t&&(r.activeThread=-1,r.removeFromActiveList());case 55:case"end":return e.stop()}}),e,null,[[9,43,46,49]])}))),this.keyLED=t,this.repeat=n,this.canvas=a,this.id=i,this.id_str="".concat(i[0]," ").concat(i[1]," ").concat(i[2]," ").concat(i[3]),this.activeList=o}return Object(l.a)(e,[{key:"wait",value:function(e){var t=this.lastEventTime+e-Date.now();return this.lastEventTime+=e,t>5?new Promise((function(e){return setTimeout(e,t)})):void 0}},{key:"getID",value:function(){return this.nextID++}},{key:"stop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(-1!==this.activeThread){if(this.activeThread=-1,e)for(var t in this.currentOn){var n=Object(y.a)(this.currentOn[t],2),a=n[0],i=n[1];this.canvas.setColor(a,i,0)}this.currentOn=[],this.removeFromActiveList()}}},{key:"endLoop",value:function(){this.end=!0}},{key:"removeFromActiveList",value:function(){delete this.activeList[this.id_str]}}]),e}(),C=function(){function e(t,n){var a=this;Object(u.a)(this,e),this.autoplay=void 0,this.status="STOPPED",this.progress=0,this.total=0,this.led=!0,this.currentChain=0,this.canvas=void 0,this.lastEventTime=void 0,this.play=function(){var e=Object(g.a)(F.a.mark((function e(t){var n,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===a.progress&&a.canvas.initlalizeCanvas(),a.status="PLAYING",a.lastEventTime=Date.now(),n=F.a.mark((function e(){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("STOPPED"!==a.status&&"PAUSED"!==a.status){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(console.log(a.autoplay[a.progress]),n=a.autoplay[a.progress].split(" "),void 0!==t&&t([a.progress,a.autoplay.length]),!(n.length<2)){e.next=7;break}return e.abrupt("return","continue");case 7:a.canvas.currentChain!=a.currentChain&&a.canvas.chainChange(a.currentChain),e.t0=n[0],e.next="o"===e.t0||"on"===e.t0?11:"f"===e.t0||"off"===e.t0?13:"t"===e.t0||"touch"===e.t0?15:"d"===e.t0||"delay"===e.t0?17:"c"===e.t0||"chain"===e.t0?23:26;break;case 11:return a.led?a.canvas.keyOn(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0):(a.canvas.keyOn(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0,!0,!1),a.canvas.setColor(parseInt(n[2])-1,parseInt(n[1])-1,127)),e.abrupt("break",26);case 13:return a.led?a.canvas.keyOff(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0):(a.canvas.keyOff(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0),a.canvas.setColor(parseInt(n[2])-1,parseInt(n[1])-1,0)),e.abrupt("break",26);case 15:return a.led?(a.canvas.keyOn(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0),a.canvas.keyOff(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0)):(a.canvas.keyOn(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0,!0,!1),a.canvas.keyOff(parseInt(n[2])-1,parseInt(n[1])-1,void 0,!0),a.canvas.setColor(parseInt(n[2])-1,parseInt(n[1])-1,3),setTimeout((function(){a.canvas.setColor(parseInt(n[2])-1,parseInt(n[1])-1,0)}),200)),e.abrupt("break",26);case 17:if(!(parseInt(n[1])<10)){e.next=20;break}return e.abrupt("break",26);case 20:return e.next=22,a.wait(parseInt(n[1]));case 22:return e.abrupt("break",26);case 23:return a.canvas.chainChange(parseInt(n[1])-1),a.currentChain=parseInt(n[1])-1,e.abrupt("break",26);case 26:case"end":return e.stop()}}),e)})),a.progress;case 5:if(!(a.progress<a.autoplay.length)){e.next=15;break}return e.delegateYield(n(),"t0",7);case 7:if("continue"!==(i=e.t0)){e.next=10;break}return e.abrupt("continue",12);case 10:if("object"!==typeof i){e.next=12;break}return e.abrupt("return",i.v);case 12:a.progress++,e.next=5;break;case 15:a.status="STOPPED",a.progress=0;case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.autoplay=t,this.total=void 0===t?0:t.length,this.canvas=n}return Object(l.a)(e,[{key:"pause",value:function(){this.status="PAUSED"}},{key:"stop",value:function(){this.status="STOPPED",this.progress=0}},{key:"wait",value:function(e){var t=this.lastEventTime+e-Date.now();return this.lastEventTime+=e,t>5?new Promise((function(e){return setTimeout(e,t)})):void 0}}]),e}(),k=n(20),m=function(){function e(t,n){Object(u.a)(this,e),this.file=void 0,this.howl=void 0,this.format=void 0,this.loopTarget={},this.loopCounter={},this.file=window.URL.createObjectURL(new File([t],n)),this.format=n.toLowerCase().split(".").pop(),this.howl=new k.Howl({src:[this.file],format:[this.format],html5:!k.Howler.usingWebAudio,onend:this.onEnd.bind(this),onloaderror:function(e,t){console.error("Howler Load Error ".concat(e," ").concat(t))},onplayerror:function(e,t){console.error("Howler Play Error ".concat(e," ").concat(t))}})}return Object(l.a)(e,[{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;1!==e&&(this.howl._loop=!0);var t=this.howl.play();this.loopCounter[t]=0,this.loopTarget[t]=e}},{key:"stop",value:function(){void 0!==this.howl&&this.howl.stop()}},{key:"onEnd",value:function(e){0!==this.loopTarget[e]&&++this.loopCounter[e]>=this.loopTarget[e]&&(this.howl._loop=!1,this.howl.stop(e))}},{key:"endLoop",value:function(){for(var e in this.howl._loop=!1,this.loopTarget)this.loopTarget[e]=1}}]),e}(),j=function(){function e(t,n){return Object(u.a)(this,e),this.info={},this.soundFiles={},this.keySound=void 0,this.autoplay=void 0,this.keyLED=void 0,this.canvas=void 0,this.activeKeyLED={},this.canvas=n.current,this.unpack(t)}return Object(l.a)(e,[{key:"unpack",value:function(e){var t=this;return new Promise(function(){var a=Object(g.a)(F.a.mark((function a(i,o){var r,s,u,l,p,h,f,d,v,g,k,j,O,D,x,I,S,w,L,E,T,N,P,A,M,K,B,z,U,X,_;return F.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,console.log(t.info),r=n(32),a.next=5,r.loadAsync(e).then((function(e){return Object.values(e.files)}),(function(e){o("Failed to extract selected file"),console.log(e)}));case 5:s=a.sent,u=void 0,l=void 0,p=void 0,h={},f=Object(c.a)(s),a.prev=11,v=F.a.mark((function e(){var n,a,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.value,(a=n.name.toLowerCase()).endsWith("/")){e.next=37;break}if(!a.includes("sounds/")){e.next=10;break}return console.log("Sound file: "+a),e.next=7,n.async("blob").then((function(e){return new m(e,a.split("/").pop())}));case 7:t.soundFiles[a.split("/").pop()]=e.sent,e.next=37;break;case 10:return e.next=12,n.async("text").then((function(e){return e.split(/\r?\n/)}));case 12:if(i=e.sent,!a.endsWith("info")){e.next=36;break}if(console.log("Info file: "+a),u=a.slice(0,-4),console.log(" project root: "+u),i.forEach((function(e){return t.info[e.split("=")[0]]=e.split("=")[1]})),t.info.buttonX=parseInt(t.info.buttonX),t.info.buttonY=parseInt(t.info.buttonY),t.info.chain=parseInt(t.info.chain),t.info.squareButton="true"===t.info.squareButton,t.info.landscape="true"===t.info.landscape,console.log(" title: "+t.info.title),console.log(" producerName: "+t.info.producerName),console.log(" buttonX: "+t.info.buttonX),console.log(" buttonY: "+t.info.buttonY),console.log(" chain: "+t.info.chain),console.log(" squareButton: "+t.info.squareButton),console.log(" landscape: "+t.info.landscape),8===t.info.buttonX&&8===t.info.buttonY){e.next=33;break}return o("Only 8x8 Unipad project are supported"),e.abrupt("return",{v:void 0});case 33:t.info.chain,e.next=37;break;case 36:a.endsWith("keysound")?(console.log("KeySound file: "+a),l=i):a.endsWith("autoplay")?(console.log("AutoPlay file: "+a),p=i):a.includes("keyled/")?(console.log("KeyLED file: "+a),h[a]=i):console.log("Unknown file: "+a);case 37:case"end":return e.stop()}}),e)})),f.s();case 14:if((d=f.n()).done){a.next=21;break}return a.delegateYield(v(),"t0",16);case 16:if("object"!==typeof(g=a.t0)){a.next=19;break}return a.abrupt("return",g.v);case 19:a.next=14;break;case 21:a.next=26;break;case 23:a.prev=23,a.t1=a.catch(11),f.e(a.t1);case 26:return a.prev=26,f.f(),a.finish(26);case 29:for(t.keySound=new Array(t.info.chain).fill(null).map((function(){return new Array(t.info.buttonX).fill(null).map((function(){return new Array(t.info.buttonY).fill(null).map((function(){return new Array}))}))})),t.keyLED=new Array(t.info.chain).fill(null).map((function(){return new Array(t.info.buttonX).fill(null).map((function(){return new Array(t.info.buttonY).fill(null).map((function(){return new Array}))}))})),k=0,j=Object.entries(h);k<j.length;k++){O=Object(y.a)(j[k],2),D=O[0],x=O[1],I=D.split("/").pop().split(" ");try{S=void 0!==I[4]?I[4].charCodeAt(0)-97:0,w=[parseInt(I[0])-1,parseInt(I[2])-1,parseInt(I[1])-1,parseInt(I[3])],L=w[0],E=w[1],T=w[2],N=w[3],t.keyLED[L][E][T][S]=new b(x,N,t.canvas,[L,E,T,S],t.activeKeyLED)}catch(H){console.warn("Unable to parse file name - "+D.split("/").pop())}}P=Object(c.a)(l),a.prev=33,P.s();case 35:if((A=P.n()).done){a.next=52;break}if(M=(M=A.value).trim(),a.prev=38,""!=M){a.next=41;break}return a.abrupt("continue",50);case 41:K=M.split(" "),B=[parseInt(K[0])-1,parseInt(K[2])-1,parseInt(K[1])-1,K[3].toLowerCase()],z=B[0],U=B[1],X=B[2],_=B[3],console.log([z,U,X,_]),t.keySound[z][U][X].push([t.soundFiles[_],K.slice(4)]),a.next=50;break;case 47:a.prev=47,a.t2=a.catch(38),console.warn("Unable to parse line - "+M);case 50:a.next=35;break;case 52:a.next=57;break;case 54:a.prev=54,a.t3=a.catch(33),P.e(a.t3);case 57:return a.prev=57,P.f(),a.finish(57);case 60:void 0!==p&&(t.autoplay=new C(p,t.canvas)),i(t),a.next=67;break;case 64:a.prev=64,a.t4=a.catch(0),o(a.t4);case 67:case"end":return a.stop()}}),a,null,[[0,64],[11,23,26,29],[33,54,57,60],[38,47]])})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"stopKeySound",value:function(){k.Howler.stop()}},{key:"stopKeyLED",value:function(){for(var e in this.activeKeyLED){var t=Object(y.a)(this.activeKeyLED[e],4),n=t[0],a=t[1],i=t[2],o=t[3];this.keyLED[n][a][i][o].stop(!1),delete this.activeKeyLED[e]}setTimeout(this.canvas.clearCanvas(),200)}},{key:"stopAll",value:function(){this.stopKeyLED(),this.stopKeySound()}}]),e}(),O=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={keyState:!1},e.on=function(){e.keyState||(e.keyState=!0,e.props.on(e.props.x,e.props.y))},e.off=function(){e.keyState&&(e.keyState=!1,e.props.off(e.props.x,e.props.y))},e.shouldUpdate=function(t){return e.props.color!==t.color},e.render=function(){return Object(a.jsxs)("div",{style:{position:"relative",display:"grid"},children:[e.isTouchDevice()?Object(a.jsx)("button",{className:e.props.class,style:{backgroundColor:e.props.color},onTouchStart:e.on,onTouchEnd:e.off,onTouchCancel:e.off}):Object(a.jsx)("button",{className:e.props.class,style:{backgroundColor:e.props.color},onMouseDown:e.on,onMouseUp:e.off,onMouseLeave:e.off}),Object(a.jsx)("div",{className:e.props.overlayClass})]})},e}return Object(l.a)(n,[{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}}]),n}(i.Component),D=["#808080","#dadfe4","#e6e9ed","#fafafa","#f8bbd0","#ef5350","#e57373","#ef9a9a","#fff3e0","#ffa726","#ffb960","#ffcc80","#ffe0b2","#ffee58","#fff59d","#fff9c4","#dcedc8","#8bc34a","#aed581","#bfdf9f","#5ee2b0","#00ce3c","#00ba43","#119c3f","#57ecc1","#00e864","#00e05c","#00d545","#7afddd","#00e4c5","#00e0b2","#01eec6","#49efef","#00e7d8","#00e5d1","#01efde","#6addff","#00dafe","#01d6ff","#08acdc","#73cefe","#0d9bf7","#148de4","#2a77c9","#8693ff","#2196f3","#4668f6","#4153dc","#b095ff","#8453fd","#634acd","#5749c5","#ffb7ff","#e863fb","#d655ed","#d14fe9","#fc99e3","#e736c2","#e52fbe","#e334b6","#ed353e","#ffa726","#f4df0b","#66bb6a","#5cd100","#00d29e","#2388ff","#3669fd","#00b4d0","#475cdc","#f2f3f5","#eef0f2","#f72737","#d2ea7b","#c8df10","#7fe422","#00c931","#00d7a6","#00d8fc","#0b9bfc","#585cf5","#ac59f0","#d980dc","#b8814a","#ff9800","#abdf22","#9ee154","#66bb6a","#3bda47","#6fdeb9","#27dbda","#9cc8fd","#79b8f7","#afafef","#d580eb","#f74fca","#ea8a1f","#dbdb08","#9cd60d","#f3d335","#c8af41","#00ca69","#24d2b0","#757ebe","#5388db","#e5c5a6","#e93b3b","#f9a2a1","#ed9c65","#e1ca72","#b8da78","#98d52c","#626cbd","#cac8a0","#90d4c2","#ceddfe","#beccf7","#d2d7de","#dadfe4","#e6e9ed","#fe1624","#cd2724","#9ccc65","#009c1b","#ffff00","#beb212","#f5d01d","#e37829"],x=["#000000","#3F3F3F","#7F7F7F","#FFFFFF","#FF3F3F","#FF0000","#7F0000","#3F0000","#FFBF6F","#FF3F00","#7F1F00","#3F0F00","#FFAF2F","#FFFF00","#7F7F00","#3F3F00","#7FFF2F","#4FFF00","#2F7F00","#173F00","#4FFF3F","#00FF00","#007F00","#003F00","#4FFF4F","#00FF1F","#007F0F","#003F07","#4FFF5F","#00FF5F","#007F2F","#003F17","#4FFFBF","#00FF9F","#007F4F","#003F27","#4FBFFF","#00AFFF","#00577F","#002F3F","#4F7FFF","#0057FF","#002F7F","#00173F","#2F1FFF","#0000FF","#00007F","#00003F","#5F3FFF","#2F00FF","#17007F","#0F003F","#FF3FFF","#FF00FF","#7F007F","#3F003F","#FF3F6F","#FF004F","#7F002F","#3F001F","#FF0F00","#9F3F00","#7F4F00","#2F2F00","#003F00","#003F1F","#001F6F","#0000FF","#003F3F","#1F00BF","#5F3F4F","#1F0F17","#FF0000","#BFFF2F","#AFEF00","#5FFF00","#0F7F00","#00FF5F","#009FFF","#002FFF","#1F00FF","#5F00EF","#AF1F7F","#2F0F00","#FF2F00","#7FDF00","#6FFF1F","#00FF00","#3FFF2F","#5FEF6F","#3FFFCF","#5F8FFF","#2F4FCF","#6F4FDF","#DF1FFF","#FF005F","#FF4F00","#BFAF00","#8FFF00","#7F5F00","#3F2F00","#00470F","#0F4F1F","#17172F","#171F5F","#5F3717","#7F0000","#DF3F2F","#DF470F","#FFBF1F","#9FDF2F","#6FAF0F","#17172F","#DFDF6F","#7FEF8F","#9F9FFF","#8F6FFF","#3F3F3F","#6F6F6F","#DFFFFF","#9F0000","#370000","#17CF00","#003F00","#BFAF00","#3F2F00","#AF4F00","#4F0F00"],I={"\u25fb":{class:"LEDButtonSquare"},"\u25fc\ufe0f":{class:"LEDButtonSquare",overlayClass:"LEDButtonSquareOverlay"},"\u25ef":{class:"LEDButtonCircle75",overlayClass:"LEDButtonCircle75Overlay"},"\u2b24":{class:"LEDButtonCircle75",overlayClass:"LEDButtonCircle75Overlay"},"\u25f8":{class:"LEDButtonSquare"},"\u25f9":{class:"LEDButtonSquare"},"\u25fa":{class:"LEDButtonSquare"},"\u22bf":{class:"LEDButtonSquare"},"\u25e4":{class:"LEDButtonSquare",overlayClass:"LEDButtonSquareOverlay"},"\u25e5":{class:"LEDButtonSquare",overlayClass:"LEDButtonSquareOverlay"},"\u25e3":{class:"LEDButtonSquare",overlayClass:"LEDButtonSquareOverlay"},"\u25e2":{class:"LEDButtonSquare",overlayClass:"LEDButtonSquareOverlay"},"\u25ac":{class:"LEDButtonRectangle",overlayClass:"LEDButtonRectangleOverlay"},"\u29bf":{class:"LEDButtonCircleLarge",overlayClass:"LEDButtonCircleLargeOverlay"},"\u2317":{class:"LEDButtonFull"}},S=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={colormap:new Array(a.props.layoutConfig.width).fill(null).map((function(){return new Array(a.props.layoutConfig.height).fill(D[0])}))},a.keypressHistory=new Array(a.props.layoutConfig.width).fill(null).map((function(){return new Array(a.props.layoutConfig.height).fill(0)})),a.currentChain=0,a.midiInputHandler=function(e){console.log(e.data);var t=Object(y.a)(e.data,3),n=t[0],i=t[1],o=t[2],r=void 0,s=void 0;if(void 0!==a.props.inputConfig.noteToXY){var c=a.props.inputConfig.noteToXY(i);if(void 0==c)return;var u=Object(y.a)(c,2);r=u[0],s=u[1]}else{var l=a.indexOf2dArray(i,a.props.inputConfig.keymap),p=Object(y.a)(l,2);r=p[0],s=p[1]}if(console.log([r,s]),void 0!==r&&void 0!==s)switch(n>>4){case 9:case 11:if(0!=o){a.keyOn(r,s,a.props.inputConfig);break}case 8:a.keyOff(r,s,a.props.inputConfig)}},a.keyOn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.props.layoutConfig,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=1,c=e,u=t;if(i){var l=a.arrayCalculation([e,t],n.canvas_origin,"+"),p=Object(y.a)(l,2);e=p[0],t=p[1]}else{var h=a.arrayCalculation([e,t],n.canvas_origin,"-"),f=Object(y.a)(h,2);c=f[0],u=f[1]}if(console.log("Note On - "+e.toString()+" "+t.toString()),void 0!==a.props.projectFile&&c>=0&&c<8&&u>=0&&u<8){if(r&&void 0!==a.props.projectFile.keyLED&&void 0!==a.props.projectFile.keyLED[a.currentChain]&&void 0!==a.props.projectFile.keyLED[a.currentChain][c]&&void 0!==a.props.projectFile.keyLED[a.currentChain][c][u]&&a.props.projectFile.keyLED[a.currentChain][c][u].length>0){var d=a.keypressHistory[c][u]%a.props.projectFile.keyLED[a.currentChain][c][u].length;a.props.projectFile.keyLED[a.currentChain][c][u][d].stop(),a.props.projectFile.keyLED[a.currentChain][c][u][d].play()}if(o&&void 0!==a.props.projectFile.keySound&&void 0!==a.props.projectFile.keySound[a.currentChain]&&void 0!==a.props.projectFile.keySound[a.currentChain][c]&&void 0!==a.props.projectFile.keySound[a.currentChain][c][u]&&a.props.projectFile.keySound[a.currentChain][c][u].length>0){var v=a.keypressHistory[c][u]%a.props.projectFile.keySound[a.currentChain][c][u].length;void 0!==a.props.projectFile.keySound[a.currentChain][c][u][v][1]&&void 0!==a.props.projectFile.keySound[a.currentChain][c][u][v][1][0]&&(s=parseInt(a.props.projectFile.keySound[a.currentChain][c][u][v][1][0])),a.props.projectFile.keySound[a.currentChain][c][u][v][0].stop(),a.props.projectFile.keySound[a.currentChain][c][u][v][0].play(s)}}},a.checkChain=function(e,t,n){if(void 0!==n.chainKey)for(var i=0;i<Math.min(n.chainKey.length,a.props.projectFile.info.chain);i++)n.chainKey[i][0]===e&&n.chainKey[i][1]===t&&a.chainChange(i)},a.keyOff=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.props.layoutConfig,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=e,c=t;if(i){var u=a.arrayCalculation([e,t],n.canvas_origin,"+"),l=Object(y.a)(u,2);e=l[0],t=l[1]}else{var p=a.arrayCalculation([e,t],n.canvas_origin,"-"),h=Object(y.a)(p,2);s=h[0],c=h[1]}if(console.log("Note Off - "+e.toString()+" "+t.toString()),void 0!==a.props.projectFile)if(s>=0&&s<8&&c>=0&&c<8){if(r&&void 0!==a.props.projectFile.keyLED&&void 0!==a.props.projectFile.keyLED[a.currentChain]&&void 0!==a.props.projectFile.keyLED[a.currentChain][s]&&void 0!==a.props.projectFile.keyLED[a.currentChain][s][c]&&a.props.projectFile.keyLED[a.currentChain][s][c].length>0){var f=a.keypressHistory[s][c]%a.props.projectFile.keyLED[a.currentChain][s][c].length;void 0!==a.props.projectFile.keyLED[a.currentChain][s][c][f]&&0===a.props.projectFile.keyLED[a.currentChain][s][c][f].repeat&&a.props.projectFile.keyLED[a.currentChain][s][c][f].endLoop()}if(o&&void 0!==a.props.projectFile.keySound&&void 0!==a.props.projectFile.keySound[a.currentChain]&&void 0!==a.props.projectFile.keySound[a.currentChain][s]&&void 0!==a.props.projectFile.keySound[a.currentChain][s][c]&&a.props.projectFile.keySound[a.currentChain][s][c].length>0){var d=a.keypressHistory[s][c]%a.props.projectFile.keySound[a.currentChain][s][c].length;if(void 0!==a.props.projectFile.keySound[a.currentChain][s][c][d][1]&&("0"==a.props.projectFile.keySound[a.currentChain][s][c][d][1][0]&&a.props.projectFile.keySound[a.currentChain][s][c][d][0].endLoop(),void 0!==a.props.projectFile.keySound[a.currentChain][s][c][d][1][1])){var v=parseInt(a.props.projectFile.keySound[a.currentChain][s][c][d][1][1])-1;console.log("Wormhole to Chain ".concat(v+1)),a.chainChange(v)}}void 0!=a.keypressHistory[s]&&void 0!=a.keypressHistory[s][c]&&a.keypressHistory[s][c]++}else a.checkChain(e,t,n)},a.chainChange=function(e){console.log("Chain Changed to "+(e+1)),e!==a.currentChain&&a.clearKeypressHistory(),a.currentChain=e},a.setColor=function(e,t,n){a.setColorCanvas(e,t,n),a.setColorOutput(e,t,n)},a.arrayCalculation=function(e,t,n){var a=[];if(e.length===t.length)switch(n){case"+":for(var i=0;i<e.length;i++)a.push(e[i]+t[i]);return a;case"-":for(i=0;i<e.length;i++)a.push(e[i]-t[i]);return a}},setInterval((function(){a.setState({colormap:a.state.colormap})}),1e3/60),a}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.projectFile!==this.props.projectFile&&(console.log("Project File Loaded"),this.initlalizeCanvas()),e.layoutConfig!==this.props.layoutConfig&&this.initlalizeCanvas(e.layoutConfig),e.inputDevice!==this.props.inputDevice&&this.setupMidiInput(e.inputDevice,this.props.inputDevice),!0}},{key:"initlalizeCanvas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.layoutConfig;this.clearCanvas(e),this.clearKeypressHistory(),this.currentChain=0}},{key:"clearCanvas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.layoutConfig;this.state.colormap=new Array(e.width).fill(null).map((function(){return new Array(e.height).fill(D[0])}))}},{key:"clearKeypressHistory",value:function(){this.keypressHistory=new Array(8).fill(null).map((function(){return new Array(8).fill(0)}))}},{key:"setupMidiInput",value:function(e,t){void 0!==t&&t.removeListener(),void 0!==e&&e.addListener("midimessage","all",this.midiInputHandler.bind(this))}},{key:"setColorCanvas",value:function(e,t,n){var a=void 0,i=void 0;if("l"===e){if(void 0==this.props.layoutConfig.lKey)return;var o=Object(y.a)(this.props.layoutConfig.lKey,2);a=o[0],i=o[1]}else if("mc"===e){if(void 0===this.props.layoutConfig.mcTable||null==this.props.layoutConfig.mcTable[t])return;var r=Object(y.a)(this.props.layoutConfig.mcTable[t],2);a=r[0],i=r[1]}else{var s=this.arrayCalculation([e,t],this.props.layoutConfig.canvas_origin,"+"),c=Object(y.a)(s,2);a=c[0],i=c[1]}try{/^#[0-9A-F]{6}$/i.test(n)?this.state.colormap[a][i]=n:this.state.colormap[a][i]=D[n]}catch(u){console.error(u),console.error([e,t,n,a,i])}}},{key:"setColorOutput",value:function(e,t,n){if(void 0!==this.props.outputDevice&&void 0!==this.props.outputConfig){var a=void 0,i=void 0;if("l"===e){if(void 0==this.props.outputConfig.lKey)return;var o=Object(y.a)(this.props.outputConfig.lKey,2);a=o[0],i=o[1]}else if("mc"===e){if(void 0===this.props.outputConfig.mcTable||null==this.props.outputConfig.mcTable[t])return;var r=Object(y.a)(this.props.outputConfig.mcTable[t],2);a=r[0],i=r[1]}else{var s=this.arrayCalculation([e,t],this.props.outputConfig.canvas_origin,"+"),c=Object(y.a)(s,2);a=c[0],i=c[1]}try{/^#[0-9A-F]{6}$/i.test(n)?this.sendSysex(this.props.outputConfig.hexSysexGen(i,a,n)):this.sendMidi("NoteOn",this.props.outputConfig.channel,this.props.outputConfig.keymap[i][a],n)}catch(u){console.error(u),console.error([e,t,n,a,i])}}}},{key:"sendMidi",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if("string"===typeof n){var i=n.charAt(0);switch(n=parseInt(n.substr(1)),i){case"C":e="CC";break;case"X":e="HEX";break;default:return}}switch(e){case"NoteOn":this.props.outputDevice.send(144+t-1,[n,a]);break;case"NoteOff":this.props.outputDevice.send(128+t-1,[n,a]);break;case"CC":this.props.outputDevice.send(176+t-1,[n,a]);break;case"HEX":this.sendSysex(this.props.outputConfig.hexSysexGen(n,x[a]))}}},{key:"sendSysex",value:function(e){this.props.outputDevice.sendSysex([],e)}},{key:"indexOf2dArray",value:function(e,t){for(var n=0,a=t.length;n<a;n++)for(var i=0,o=t[n].length;i<o;i++)if(t[n][i]===e)return[i,n];return[void 0,void 0]}},{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{className:"canvas",style:{padding:this.props.layoutConfig.padding,borderRadius:this.props.layoutConfig.radius},children:this.props.layoutConfig.layout.map((function(t,n){return Object(a.jsx)("div",{className:"button-row",children:e.props.layoutConfig.layout[n].map((function(t,i){return Object.keys(I).includes(t)?Object(a.jsx)(O,{x:i,y:n,class:I[t].class,overlayClass:I[t].overlayClass,color:e.state.colormap[i][n],on:e.keyOn,off:e.keyOff}):Object(a.jsx)("div",{style:{width:"96px"}},"Spacer "+i.toString()+"-"+n.toString())}))})}))})}}]),n}(i.Component),w={defaultLayout:"Launchpad Pro"},L={"Launchpad Pro":{channel:1,midiNameRegex:"Launchpad Pro",initializationSysex:[[0,32,41,2,16,33,0],[0,32,41,2,16,14,0],[0,32,41,2,16,10,99,0]],layout:[["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25f8","\u25f9","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fa","\u22bf","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24"," "]],keymap:[[null,91,92,93,94,95,96,97,98,null],[80,81,82,83,84,85,86,87,88,89],[70,71,72,73,74,75,76,77,78,79],[60,61,62,63,64,65,66,67,68,69],[50,51,52,53,54,55,56,57,58,59],[40,41,42,43,44,45,46,47,48,49],[30,31,32,33,34,35,36,37,38,39],[20,21,22,23,24,25,26,27,28,29],[10,11,12,13,14,15,16,17,18,19],[null,1,2,3,4,5,6,7,8,"X99"]],width:10,height:10,padding:25,radius:15,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],lKey:[9,9],noteToXY:function(e){if(e>=1&&e<=99)return[e%10,9-Math.floor(e/10)]},hexSysexGen:function(){if(2!=arguments.length&&3!=arguments.length)return[];switch(arguments.length){case 2:var e=arguments[0],t=arguments[1];break;case 3:var n=arguments[0]+1,a=arguments[1]+1;e=10*n+a,t=arguments[2];break;default:return[]}if("string"!==typeof t||"#"!==t.charAt(0))return[];var i=(t=parseInt(t.substr(1),16))>>16>>2,o=(255&t)>>2,r=(255&t)>>2;return[0,32,41,2,16,11,e,i,o,r]}},"Launchpad Pro (Phantom)":{layout:[["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25e4","\u25e5","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25e3","\u25e2","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u2b24","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u2b24"],["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24"," "]],width:10,height:10,padding:25,radius:15,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],lKey:[9,9]},"Launchpad Pro (CFW)":{channel:16,midiNameRegex:"Launchpad Open",initializationSysex:[[0,32,41,2,16,33,1],[0,32,41,2,16,14,0]],keymap:[[null,28,29,30,31,32,33,34,35,null],[108,64,65,66,67,96,97,98,99,100],[109,60,61,62,63,92,93,94,95,101],[110,56,57,58,59,88,89,90,91,102],[111,52,53,54,55,84,85,86,87,103],[112,48,49,50,51,80,81,82,83,104],[113,44,45,46,47,76,77,78,79,105],[114,40,41,42,43,72,73,74,75,106],[115,36,37,38,39,68,69,70,71,107],[null,116,117,118,119,120,121,122,123,27]],width:10,height:10,padding:30,radius:15,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],lKey:[9,9],noteToXY:function(e){if(e>=36&&e<=99){return[[1,8],[2,8],[3,8],[4,8],[1,7],[2,7],[3,7],[4,7],[1,6],[2,6],[3,6],[4,6],[1,5],[2,5],[3,5],[4,5],[1,4],[2,4],[3,4],[4,4],[1,3],[2,3],[3,3],[4,3],[1,2],[2,2],[3,2],[4,2],[1,1],[2,1],[3,1],[4,1],[5,8],[6,8],[7,8],[8,8],[5,7],[6,7],[7,7],[8,7],[5,6],[6,6],[7,6],[8,6],[5,5],[6,5],[7,5],[8,5],[5,4],[6,4],[7,4],[8,4],[5,3],[6,3],[7,3],[8,3],[5,2],[6,2],[7,2],[8,2],[5,1],[6,1],[7,1],[8,1]][e-36]}return e>=100&&e<=107?this.mcTable[e-100+8]:e>=116&&e<=123?this.mcTable[7-(e-116)+16]:e>=108&&e<=115?this.mcTable[7-(e-108)+24]:e>=28&&e<=35?this.mcTable[e-28]:27==e?this.lKey:void 0},hexSysexGen:function(){if(2!=arguments.length&&3!=arguments.length)return[];switch(arguments.length){case 2:var e=arguments[0],t=arguments[1];break;case 3:var n=arguments[0]+1,a=arguments[1]+1;e=10*n+a,t=arguments[2];break;default:return[]}if("string"!==typeof t||"#"!==t.charAt(0))return[];var i=(t=parseInt(t.substr(1),16))>>16>>2,o=(255&t)>>2,r=(255&t)>>2;return[0,32,41,2,16,11,e,i,o,r]}},"Launchpad MK2":{channel:1,midiNameRegex:"Launchpad MK2",layout:[["\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25f8","\u25f9","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fa","\u22bf","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"]],keymap:[["C104","C105","C106","C107","C108","C109","C110","C111",null],[81,82,83,84,85,86,87,88,89],[71,72,73,74,75,76,77,78,79],[61,62,63,64,65,66,67,68,69],[51,52,53,54,55,56,57,58,59],[41,42,43,44,45,46,47,48,49],[31,32,33,34,35,36,37,38,39],[21,22,23,24,25,26,27,28,29],[11,12,13,14,15,16,17,18,19]],width:9,height:9,padding:30,radius:15,canvas_origin:[0,1],chainKey:[[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8]],mcTable:[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],noteToXY:function(e){return e>=11&&e<=89?[e%10-1,9-Math.floor(e/10)]:e>=104&&e<=111?this.mcTable[e-104+24]:void 0},hexSysexGen:function(){if(2!=arguments.length&&3!=arguments.length)return[];switch(arguments.length){case 2:var e=arguments[0],t=arguments[1];break;case 3:var n=arguments[0]+1,a=arguments[1]+1;e=10*n+a,t=arguments[2];break;default:return[]}if("string"!==typeof t||"#"!==t.charAt(0))return[];var i=(t=parseInt(t.substr(1),16))>>16>>2,o=(255&t)>>2,r=(255&t)>>2;return[0,32,41,2,24,11,e,i,o,r]}},"Launchpad X":{channel:1,midiNameRegex:"Launchpad X|LPX MIDI",initializationSysex:[[0,32,41,2,12,14,1]],layout:[["\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","n"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25f8","\u25f9","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fa","\u22bf","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"]],keymap:[[91,92,93,94,95,96,97,98,99],[81,82,83,84,85,86,87,88,89],[71,72,73,74,75,76,77,78,79],[61,62,63,64,65,66,67,68,69],[51,52,53,54,55,56,57,58,59],[41,42,43,44,45,46,47,48,49],[31,32,33,34,35,36,37,38,39],[21,22,23,24,25,26,27,28,29],[11,12,13,14,15,16,17,18,19]],width:9,height:9,padding:30,radius:5,canvas_origin:[0,1],chainKey:[[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8]],mcTable:[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],lKey:[0,9],noteToXY:function(e){if(e>=11&&e<=99)return[e%10-1,9-Math.floor(e/10)]},hexSysexGen:function(){if(2!=arguments.length&&3!=arguments.length)return[];switch(arguments.length){case 2:var e=arguments[0];if(null==this.mcTable[e])return[];var t=this.mcTable[e],n=arguments[1];break;case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];break;default:return[]}var i=10*a+t,o=n>>16>>1,r=(255&n)>>1,s=(255&n)>>1;return[0,32,41,2,12,3,3,i,o,r,s]}},"Launchpad Pro MK3":{channel:1,midiNameRegex:"Launchpad Pro MK3",initializationSysex:[[0,32,41,2,12,14,0,17,0]],layout:[["\u3000","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","n"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25f8","\u25f9","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fa","\u22bf","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u25fc\ufe0f","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fc\ufe0f"],["\u3000","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f","\u25fc\ufe0f"," "]],keymap:[[null,91,92,93,94,95,96,97,98,99],[80,81,82,83,84,85,86,87,88,89],[70,71,72,73,74,75,76,77,78,79],[60,61,62,63,64,65,66,67,68,69],[50,51,52,53,54,55,56,57,58,59],[40,41,42,43,44,45,46,47,48,49],[30,31,32,33,34,35,36,37,38,39],[20,21,22,23,24,25,26,27,28,29],[10,11,12,13,14,15,16,17,18,19],[null,1,2,3,4,5,6,7,8,null]],width:10,height:10,padding:25,radius:5,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],lKey:[0,9],noteToXY:function(e){return e>=1&&e<=99?[e%10,9-Math.floor(e/10)]:e>=101&&e<=108?[e-100,9]:void 0},hexSysexGen:function(){if(2!=arguments.length&&3!=arguments.length)return[];switch(arguments.length){case 2:var e=arguments[0],t=this.mcTable[e],n=arguments[1];break;case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];break;default:return[]}var i=10*a+t,o=n>>16>>1,r=(255&n)>>1,s=(255&n)>>1;return[0,32,41,2,14,3,3,i,o,r,s]}},Matrix:{channel:2,midiNameRegex:"^Matrix",layout:[["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25f8","\u25f9","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fa","\u22bf","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"]],keymap:[[64,65,66,67,96,97,98,99],[60,61,62,63,92,93,94,95],[56,57,58,59,88,89,90,91],[52,53,54,55,84,85,86,87],[48,49,50,51,80,81,82,83],[44,45,46,47,76,77,78,79],[40,41,42,43,72,73,74,75],[36,37,38,39,68,69,70,71],[100,101,102,103,104,105,106,107]],width:8,height:8,padding:20,radius:15,canvas_origin:[0,0],chainKey:[[0,8],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8]],noteToXY:function(e){if(e>35&&e<100){return[[0,7],[1,7],[2,7],[3,7],[0,6],[1,6],[2,6],[3,6],[0,5],[1,5],[2,5],[3,5],[0,4],[1,4],[2,4],[3,4],[0,3],[1,3],[2,3],[3,3],[0,2],[1,2],[2,2],[3,2],[0,1],[1,1],[2,1],[3,1],[0,0],[1,0],[2,0],[3,0],[4,7],[5,7],[6,7],[7,7],[4,6],[5,6],[6,6],[7,6],[4,5],[5,5],[6,5],[7,5],[4,4],[5,4],[6,4],[7,4],[4,3],[5,3],[6,3],[7,3],[4,2],[5,2],[6,2],[7,2],[4,1],[5,1],[6,1],[7,1],[4,0],[5,0],[6,0],[7,0]][e-36]}if(e>99&&e<108)return this.chainKey[e-100]},hexSysexGen:function(){if(3!=arguments.length)return[];switch(arguments.length){case 3:var e=arguments[2];break;default:return}var t=e>>16>>1,n=(255&e)>>1,a=(255&e)>>1;return[240,0,2,3,1,0,18,32,0,3,t,n,a,247]}},"Midi Fighter 64":{channel:1,midiNameRegex:"^Midi Fighter 64",layout:[["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"],["\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf","\u29bf"]],keymap:[[64,65,66,67,96,97,98,99],[60,61,62,63,92,93,94,95],[56,57,58,59,88,89,90,91],[52,53,54,55,84,85,86,87],[48,49,50,51,80,81,82,83],[44,45,46,47,76,77,78,79],[40,41,42,43,72,73,74,75],[36,37,38,39,68,69,70,71]],width:8,height:8,padding:20,radius:50,canvas_origin:[0,0],noteToXY:function(e){if(e>35&&e<100){return[[0,7],[1,7],[2,7],[3,7],[0,6],[1,6],[2,6],[3,6],[0,5],[1,5],[2,5],[3,5],[0,4],[1,4],[2,4],[3,4],[0,3],[1,3],[2,3],[3,3],[0,2],[1,2],[2,2],[3,2],[0,1],[1,1],[2,1],[3,1],[0,0],[1,0],[2,0],[3,0],[4,7],[5,7],[6,7],[7,7],[4,6],[5,6],[6,6],[7,6],[4,5],[5,5],[6,5],[7,5],[4,4],[5,4],[6,4],[7,4],[4,3],[5,3],[6,3],[7,3],[4,2],[5,2],[6,2],[7,2],[4,1],[5,1],[6,1],[7,1],[4,0],[5,0],[6,0],[7,0]][e-36]}},hexSysexGen:function(){if(3!=arguments.length)return[];switch(arguments.length){case 3:var e=arguments[2];break;default:return}var t=e>>16>>1,n=(255&e)>>1,a=(255&e)>>1;return[240,0,2,3,1,0,18,32,0,3,t,n,a,247]}}},E=n(17),T=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).playAutoplay=function(){void 0!==a.props.project.autoplay?a.props.project.autoplay.play():alert("No project loaded!")},a.stopAutoplay=function(){void 0!==a.props.project.autoplay?(a.props.project.autoplay.stop(),a.props.canvas.current.initlalizeCanvas()):alert("No project loaded!")},a.pauseAutoplay=function(){void 0!==a.props.project.autoplay?(a.props.project.autoplay.pause(),a.props.project.stopAll()):alert("No project loaded!")},setInterval((function(){void 0!==a.props.project&&void 0!==a.props.project.autoplay&&a.forceUpdate()}),1e3/60),a}return Object(l.a)(n,[{key:"render",value:function(){var e=Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px"},onClick:this.playAutoplay,children:"Play"}),t=Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px"},onClick:this.pauseAutoplay,children:"Pause"}),n=Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px"},onClick:this.stopAutoplay,children:"Stop"}),i=[],o="";if(void 0==this.props.project||void 0==this.props.project.autoplay||0===this.props.project.autoplay.total)return null;switch(this.props.project.autoplay.status){case"PLAYING":o=" - ".concat((this.props.project.autoplay.progress/this.props.project.autoplay.total*100).toFixed(2),"% completed (").concat(this.props.project.autoplay.progress,"/").concat(this.props.project.autoplay.total,")"),i.push(t);break;case"PAUSED":o=" - ".concat((this.props.project.autoplay.progress/this.props.project.autoplay.total*100).toFixed(2),"% completed (").concat(this.props.project.autoplay.progress,"/").concat(this.props.project.autoplay.total,") - Paused"),i.push(e,n);break;case"STOPPED":i.push(e)}return Object(a.jsxs)("div",{children:[Object(a.jsx)("text",{children:"Autoplay"+o}),Object(a.jsx)("div",{}),i]})}}]),n}(i.Component),N=n(16),P=n.n(N),A=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={projectFile:void 0,statusMessage:"No project loaded",midiInput:{},midiOutput:{},layoutConfigName:w.defaultLayout,layoutConfig:L[w.defaultLayout],inputDevice:void 0,inputConfigName:void 0,inputConfig:void 0,outputDevice:void 0,outputConfigName:void 0,outputConfig:void 0},a.canvas=o.a.createRef(),a.downloadProjectFile=function(e){alert("Download Unipack from "+e),fetch("https://cors-anywhere.herokuapp.com/"+e).then(function(e){var t=e.blob();console.log(t),a.loadProjectFile(t)}.bind(Object(p.a)(a)))},a.loadProjectFile=function(e){null!=e&&(a.setState({statusMessage:"Loading Unipack"}),new j(e,a.canvas).then((function(e){a.setState({projectFile:e}),console.log(e),a.setState({statusMessage:"Current Project: ".concat(a.state.projectFile.info.title," by ").concat(a.state.projectFile.info.producerName)})})).catch((function(t){a.setState({statusMessage:"Error Loading Unipack"}),alert("Error Loading Unipack: "+e.name),console.error("Error Loading Unipack"),console.error(t)})))},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){console.log("%c203 | Prismatic \nBuild 7/25/2021, 8:48:19 PM","color: cyan;font-size:24px;"),this.loadUserConfigPerfences(),setTimeout(this.initlization.bind(this),0)}},{key:"initlization",value:function(){var e=this;P.a.enable((function(t){t?e.onMIDIFailure():e.onMIDISuccess()}),!0);var t=new URLSearchParams(window.location.search);if(t.get("unipack")){var n=t.get("unipack");this.downloadProjectFile(n)}}},{key:"onMIDISuccess",value:function(){console.log("Got access your MIDI devices."),this.updateMidiList(),P.a.addListener("connected",this.onMidiStateChange.bind(this)),P.a.addListener("disconnected",this.onMidiStateChange.bind(this)),this.loadUserDevicePerfences()}},{key:"onMidiStateChange",value:function(e){console.log(e),console.log(e.port.name,e.port.type,e.port.state),"disconnected"===e.port.state&&("input"===e.port.type?void 0!==this.state.inputDevice&&this.state.inputDevice.name===e.port.name&&(this.setState({inputDevice:void 0}),this.setState({inputDeviceConfig:void 0}),this.setState({inputDeviceName:void 0})):"output"===e.port.type&&void 0!==this.state.outputDevice&&this.state.outputDevice.name===e.port.name&&(this.setState({outputDevice:void 0}),this.setState({outputDeviceConfig:void 0}),this.setState({outputDeviceName:void 0}))),this.updateMidiList()}},{key:"updateMidiList",value:function(){var e={};console.log("Input");var t,n=Object(c.a)(P.a.inputs);try{for(n.s();!(t=n.n()).done;){var a=t.value;console.log(a.name),e[a.name]=a}}catch(u){n.e(u)}finally{n.f()}this.setState({midiInput:e});var i={};console.log(),console.log("Output");var o,r=Object(c.a)(P.a.outputs);try{for(r.s();!(o=r.n()).done;){var s=o.value;console.log(s.name),i[s.name]=s}}catch(u){r.e(u)}finally{r.f()}this.setState({midiOutput:i})}},{key:"onMIDIFailure",value:function(){console.log("Could not access your MIDI devices."),alert("Could not access your MIDI devices. Try use another web browser or hardware platform.")}},{key:"autoConfigPicker",value:function(e,t){if(void 0!==e)for(var n in L)if(void 0!==L[n].midiNameRegex&&null!==e.match(L[n].midiNameRegex)){var a=L[n];switch(console.log("".concat(t?"Output":"input"," config has been auto assigned to ").concat(n)),t){case"Input":return this.setInputConfig({label:n,value:a}),!0;case"Output":return this.setOutputConfig({label:n,value:a}),!0}}return alert("Unable to find matching ".concat(t?"output":"input"," config for device ").concat(e)),!1}},{key:"render",value:function(){return Object(a.jsx)(o.a.Fragment,{children:Object(a.jsxs)("div",{className:"main",children:[Object(a.jsxs)("div",{className:"sidebar",children:[Object(a.jsx)("text",{children:"203 | Prismatic (Tech Preview Demo)"}),Object(a.jsx)("div",{className:"sidebarItem"}),Object(a.jsx)("text",{className:"sidebarItem",children:this.state.statusMessage}),Object(a.jsx)(d,{loadProjectFile:this.loadProjectFile}),Object(a.jsx)("div",{className:"sidebarItem"}),Object(a.jsx)("text",{children:"UI Layout"}),Object(a.jsx)(E.a,{className:"sidebarItem",options:this.prepSelectConfig(L,"layout"),autosize:!0,value:void 0!==this.state.layoutConfigName?{label:this.state.layoutConfigName,value:this.state.layoutConfig}:{label:"Layout Config",value:void 0},onChange:this.setLayoutConfig.bind(this)}),Object(a.jsx)("text",{children:"Midi Input Device"}),Object(a.jsx)(E.a,{className:"sidebarItem",options:this.prepSelectConfig(this.state.midiInput),autosize:!0,value:void 0!==this.state.inputDevice?{label:this.state.inputDevice.name,value:this.state.inputDevice}:{label:"Input Device",value:void 0},onChange:this.setInputDevice.bind(this)}),Object(a.jsx)("text",{children:"Midi Input Device Config"}),Object(a.jsx)(E.a,{className:"sidebarItem",options:this.prepSelectConfig(L,"keymap"),autosize:!0,value:void 0!==this.state.inputConfigName?{label:this.state.inputConfigName,value:this.state.inputConfig}:{label:"Input Device Config",value:void 0},onChange:this.setInputConfig.bind(this)}),Object(a.jsx)("text",{children:"Midi Output Device"}),Object(a.jsx)(E.a,{className:"sidebarItem",options:this.prepSelectConfig(this.state.midiOutput),autosize:!0,value:void 0!==this.state.outputDevice?{label:this.state.outputDevice.name,value:this.state.outputDevice}:{label:"Output Device",value:void 0},onChange:this.setOutputDevice.bind(this)}),Object(a.jsx)("text",{children:"Midi Output Device Config"}),Object(a.jsx)(E.a,{className:"sidebarItem",options:this.prepSelectConfig(L,"keymap"),autosize:!0,value:void 0!==this.state.outputConfigName?{label:this.state.outputConfigName,value:this.state.outputConfig}:{label:"Output Device Config",value:void 0},onChange:this.setOutputConfig.bind(this)}),Object(a.jsx)("div",{}),Object(a.jsx)(T,{project:this.state.projectFile,canvas:this.canvas,layoutConfig:this.state.layoutConfig})]}),Object(a.jsx)(S,{ref:this.canvas,projectFile:this.state.projectFile,layoutConfig:this.state.layoutConfig,inputDevice:this.state.inputDevice,inputConfig:this.state.inputConfig,outputDevice:this.state.outputDevice,outputConfig:this.state.outputConfig})]})})}},{key:"setLayoutConfig",value:function(e){this.setState({layoutConfigName:e.label}),this.setState({layoutConfig:e.value}),localStorage.setItem("perferedLayoutConfig",e.label)}},{key:"setInputConfig",value:function(e){this.setState({inputConfigName:e.label}),this.setState({inputConfig:e.value},this.initlizateInputDevice.bind(this)),localStorage.setItem("perferedInputConfig",e.label)}},{key:"setOutputConfig",value:function(e){this.setState({outputConfigName:e.label}),this.setState({outputConfig:e.value},this.initlizateOutputDevice.bind(this)),localStorage.setItem("perferedOutputConfig",e.label)}},{key:"setInputDevice",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({inputDevice:e.value}),t&&this.autoConfigPicker(e.value.name,"Input"),localStorage.setItem("perferedInputDevice",e.value.name)}},{key:"setOutputDevice",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({outputDevice:e.value}),t&&this.autoConfigPicker(e.value.name,"Output"),localStorage.setItem("perferedOutputDevice",e.value.name)}},{key:"initlizateInputDevice",value:function(){if(void 0!==this.state.inputConfig&&void 0!==this.state.inputDevice&&void 0!==this.state.inputConfig.inputInfoMessage)for(var e in this.state.inputConfig.infoMessage)alert(this.state.inputConfig.inputInfoMessage[e])}},{key:"initlizateOutputDevice",value:function(){if(void 0!==this.state.outputConfig&&void 0!==this.state.outputDevice){if(void 0!==this.state.outputConfig.initializationSysex)for(var e in this.state.outputConfig.initializationSysex)this.state.outputDevice.sendSysex([],this.state.outputConfig.initializationSysex[e]);if(void 0!==this.state.outputConfig.outputInfoMessage)for(var e in this.state.outputConfig.infoMessage)alert(this.state.outputConfig.outputInfoMessage[e])}}},{key:"prepSelectConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=[];for(var a in e)void 0!==t&&void 0===e[a][t]||n.push({label:a,value:e[a]});return n}},{key:"loadUserConfigPerfences",value:function(){var e=localStorage.getItem("perferedLayoutConfig");null!==e&&void 0!==L[e]&&this.setLayoutConfig({label:e,value:L[e]});var t=localStorage.getItem("perferedInputConfig");null!==t&&void 0!==L[t]&&this.setInputConfig({label:t,value:L[t]});var n=localStorage.getItem("perferedOutputConfig");null!==n&&void 0!==L[n]&&this.setOutputConfig({label:n,value:L[n]})}},{key:"loadUserDevicePerfences",value:function(){var e=localStorage.getItem("perferedInputDevice");null!==e&&void 0!==this.state.midiInput[e]&&this.setInputDevice({label:e,value:this.state.midiInput[e]},!1);var t=localStorage.getItem("perferedOutputDevice");null!==t&&void 0!==this.state.midiOutput[t]&&this.setOutputDevice({label:t,value:this.state.midiOutput[t]},!1)}}]),n}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(a.jsx)(A,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.12dd3103.chunk.js.map