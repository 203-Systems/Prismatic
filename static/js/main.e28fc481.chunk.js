(this.webpackJsonpprismatic=this.webpackJsonpprismatic||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(0),i=n.n(o),r=n(12),s=n.n(r),u=(n(29),n(30),n(6)),l=n(11),c=n(2),p=n(3),f=n(10),h=n(4),d=n(8),v=(o.Component,function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).onFileChange=function(t){e.props.loadProjectFile(t.target.files[0])},e}return Object(p.a)(n,[{key:"render",value:function(){return Object(a.jsx)(i.a.Fragment,{children:Object(a.jsx)("input",{type:"file",id:"projectFilePicker",name:"projectFile",accept:".zip",onChange:this.onFileChange})})}}]),n}(o.Component)),b=n(9),y=n.n(b),g=n(14),m=n(23),C=function(){function e(t,n){var a=this;Object(c.a)(this,e),this.keyLED=void 0,this.repeat=1,this.play=function(){var e=Object(g.a)(y.a.mark((function e(t){var n,o,i,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<a.repeat)){e.next=33;break}o=Object(l.a)(a.keyLED),e.prev=3,o.s();case 5:if((i=o.n()).done){e.next=22;break}if(r=i.value,!((s=r.split(" ")).length<2)){e.next=10;break}return e.abrupt("continue",20);case 10:e.t0=s[0],e.next="o"===e.t0||"on"===e.t0?13:"f"===e.t0||"off"===e.t0?15:"d"===e.t0?17:20;break;case 13:return 5===s.length?"mc"!==s[1]?t.setColorPalette(parseInt(s[2]-1),parseInt(s[1]-1),parseInt(s[4])):t.setMCColorPalette(parseInt(s[2]-1),parseInt(s[4])):4===s.length&&("mc"!==s[1]?t.setColorHEX(parseInt(s[2]-1),parseInt(s[1]-1),"#"+s[3]):t.setMCColorHEX(parseInt(s[2]-1),"#"+s[3])),e.abrupt("break",20);case 15:return"mc"!==s[1]?t.setColorPalette(parseInt(s[2]-1),parseInt(s[1]-1),0):t.setMCColorPalette(parseInt(s[2]-1),0),e.abrupt("break",20);case 17:return e.next=19,a.wait(parseInt(s[1]));case 19:return e.abrupt("break",20);case 20:e.next=5;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(3),o.e(e.t1);case 27:return e.prev=27,o.f(),e.finish(27);case 30:n++,e.next=1;break;case 33:case"end":return e.stop()}}),e,null,[[3,24,27,30]])})));return function(t){return e.apply(this,arguments)}}(),this.keyLED=t,this.repeat=n}return Object(p.a)(e,[{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),j=function(){function e(t){var n=this;Object(c.a)(this,e),this.autoplay=void 0,this.status="STOPPED",this.progress=0,this.currentChain=0,this.play=function(){var e=Object(g.a)(y.a.mark((function e(t,a,o){var i,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),console.log(a),0===n.progress&&(t.initlalizeCanvas(),n.currentChain=parseInt(0)),n.status="PLAYING",n.progress;case 5:if(!(n.progress<n.autoplay.length)){e.next=35;break}if(i=!0,console.log(n.autoplay[n.progress]),r=n.autoplay[n.progress].split(" "),void 0!==o&&o([n.progress,n.autoplay.length]),!(r.length<2)){e.next=12;break}return e.abrupt("continue",32);case 12:t.currentChain!=n.currentChain&&t.chainChange(n.currentChain),e.t0=r[0],e.next="t"===e.t0||"o"===e.t0?16:"f"===e.t0?18:"d"===e.t0?20:"c"===e.t0||"chain"===e.t0?23:26;break;case 16:return t.keyOn(parseInt(r[2])-1+a[0],parseInt(r[1])-1+a[1]),e.abrupt("break",26);case 18:return t.keyOff(parseInt(r[2])-1+a[0],parseInt(r[1])-1+a[1]),e.abrupt("break",26);case 20:return i=!1,n.wait(parseInt(r[1])).then((function(){i=!0})),e.abrupt("break",26);case 23:return t.chainChange(parseInt(r[1])-1),n.currentChain=parseInt(r[1])-1,e.abrupt("break",26);case 26:if("STOPPED"!==n.status&&"PAUSED"!==n.status){e.next=29;break}return n.progress++,e.abrupt("return");case 29:return e.next=31,n.wait(5);case 31:if(!i){e.next=26;break}case 32:n.progress++,e.next=5;break;case 35:n.status="STOPPED",n.progress=0;case 37:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),this.autoplay=t}return Object(p.a)(e,[{key:"pause",value:function(){this.status="PAUSED"}},{key:"stop",value:function(){this.status="STOPPED",this.progress=0}},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),k=function(){function e(t){return Object(c.a)(this,e),this.info={},this.soundFiles={},this.keySound=void 0,this.autoplay=void 0,this.keyLED=void 0,this.unpack(t)}return Object(p.a)(e,[{key:"unpack",value:function(e){var t=this;return new Promise(function(){var a=Object(g.a)(y.a.mark((function a(o,i){var r,s,c,p,f,h,d,v,b,g,k,x,O,w,S,I,D,F,N,P;return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(t.info),r=n(32),a.next=4,r.loadAsync(e).then((function(e){return Object.values(e.files)}),(function(e){i("Failed to extract selected file"),console.log(e)}));case 4:s=a.sent,c=void 0,p=void 0,f=void 0,h={},d=Object(l.a)(s),a.prev=10,b=y.a.mark((function e(){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=v.value).name.endsWith("/")){e.next=38;break}if(!n.name.toLowerCase().includes("sounds/")){e.next=9;break}return console.log("Sound file: "+n.name),e.next=6,n.async("blob").then((function(e){e=window.URL.createObjectURL(e);var t=n.name.split(".").pop();return new m.Howl({src:[e],format:[t]})}));case 6:t.soundFiles[n.name.split("/").pop()]=e.sent,e.next=38;break;case 9:return e.next=11,n.async("text").then((function(e){return e.split(/\r?\n/)}));case 11:if(a=e.sent,!n.name.toLowerCase().endsWith("info")){e.next=37;break}if(console.log("Info file: "+n.name),c=n.name.slice(0,-4),console.log(" project root: "+c),a.forEach((function(e){return t.info[e.split("=")[0]]=e.split("=")[1]})),t.info.buttonX=parseInt(t.info.buttonX),t.info.buttonY=parseInt(t.info.buttonY),t.info.chain=parseInt(t.info.chain),t.info.squareButton="true"===t.info.squareButton,t.info.landscape="true"===t.info.landscape,console.log(" title: "+t.info.title),console.log(" producerName: "+t.info.producerName),console.log(" buttonX: "+t.info.buttonX),console.log(" buttonY: "+t.info.buttonY),console.log(" chain: "+t.info.chain),console.log(" squareButton: "+t.info.squareButton),console.log(" landscape: "+t.info.landscape),8===t.info.buttonX&&8===t.info.buttonY){e.next=32;break}return i("Only 8x8 Unipad project are supported"),e.abrupt("return",{v:void 0});case 32:if(!(t.info.chain>8)){e.next=35;break}return alert("This Unipad Project has ".concat(t.info.chain," chains. Projects that has more than 8 chains are limited supported")),e.abrupt("return",{v:void 0});case 35:e.next=38;break;case 37:n.name.toLowerCase().endsWith("keysound")?(console.log("KeySound file: "+n.name),p=a):n.name.toLowerCase().endsWith("autoplay")?(console.log("AutoPlay file: "+n.name),f=a):n.name.toLowerCase().includes("keyled/")?(console.log("KeyLED file: "+n.name),h[n.name]=a):console.log("Unknown file: "+n.name);case 38:case"end":return e.stop()}}),e)})),d.s();case 13:if((v=d.n()).done){a.next=20;break}return a.delegateYield(b(),"t0",15);case 15:if("object"!==typeof(g=a.t0)){a.next=18;break}return a.abrupt("return",g.v);case 18:a.next=13;break;case 20:a.next=25;break;case 22:a.prev=22,a.t1=a.catch(10),d.e(a.t1);case 25:return a.prev=25,d.f(),a.finish(25);case 28:for(t.keySound=new Array(t.info.chain).fill(null).map((function(){return new Array(t.info.buttonX).fill(null).map((function(){return new Array(t.info.buttonY).fill(null).map((function(){return new Array}))}))})),t.keyLED=new Array(t.info.chain).fill(null).map((function(){return new Array(t.info.buttonX).fill(null).map((function(){return new Array(t.info.buttonY).fill(null).map((function(){return new Array}))}))})),k=0,x=Object.entries(h);k<x.length;k++)O=Object(u.a)(x[k],2),w=O[0],S=O[1],5===(I=w.split("/").pop().split(" ")).length?t.keyLED[parseInt(I[0])-1][parseInt(I[2])-1][parseInt(I[1])-1][I[4].charCodeAt(0)-97]=new C(S,parseInt(I[3])):4===I.length?t.keyLED[parseInt(I[0])-1][parseInt(I[2])-1][parseInt(I[1])-1][0]=new C(S,parseInt(I[3])):console.warn("Unknown keyLED file name: "+w);D=Object(l.a)(p),a.prev=32,D.s();case 34:if((F=D.n()).done){a.next=42;break}if(N=F.value,!((P=N.split(" ")).length<2)){a.next=39;break}return a.abrupt("continue",40);case 39:t.keySound[parseInt(P[0])-1][parseInt(P[2])-1][parseInt(P[1])-1].push([t.soundFiles[P[3]],P.slice(3)]);case 40:a.next=34;break;case 42:a.next=47;break;case 44:a.prev=44,a.t2=a.catch(32),D.e(a.t2);case 47:return a.prev=47,D.f(),a.finish(47);case 50:t.autoplay=new j(f),o(t);case 52:case"end":return a.stop()}}),a,null,[[10,22,25,28],[32,44,47,50]])})));return function(e,t){return a.apply(this,arguments)}}())}}]),e}(),x=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={keyState:!1},e.on=function(){return e.props.on(e.props.x,e.props.y)},e.off=function(){e.keyState&&(e.keyState=!e.keyState,e.props.off(e.props.x,e.props.y))},e.shouldUpdate=function(t){return e.props.color!==t.color},e.render=function(){return Object(a.jsx)("div",{children:Object(a.jsx)("button",{onMouseDown:e.on,onTouchStart:e.on,className:e.props.class,style:{backgroundColor:e.props.color}})})},e}return n}(o.Component),O=["#808080","#dadfe4","#e6e9ed","#fafafa","#f8bbd0","#ef5350","#e57373","#ef9a9a","#fff3e0","#ffa726","#ffb960","#ffcc80","#ffe0b2","#ffee58","#fff59d","#fff9c4","#dcedc8","#8bc34a","#aed581","#bfdf9f","#5ee2b0","#00ce3c","#00ba43","#119c3f","#57ecc1","#00e864","#00e05c","#00d545","#7afddd","#00e4c5","#00e0b2","#01eec6","#49efef","#00e7d8","#00e5d1","#01efde","#6addff","#00dafe","#01d6ff","#08acdc","#73cefe","#0d9bf7","#148de4","#2a77c9","#8693ff","#2196f3","#4668f6","#4153dc","#b095ff","#8453fd","#634acd","#5749c5","#ffb7ff","#e863fb","#d655ed","#d14fe9","#fc99e3","#e736c2","#e52fbe","#e334b6","#ed353e","#ffa726","#f4df0b","#66bb6a","#5cd100","#00d29e","#2388ff","#3669fd","#00b4d0","#475cdc","#f2f3f5","#eef0f2","#f72737","#d2ea7b","#c8df10","#7fe422","#00c931","#00d7a6","#00d8fc","#0b9bfc","#585cf5","#ac59f0","#d980dc","#b8814a","#ff9800","#abdf22","#9ee154","#66bb6a","#3bda47","#6fdeb9","#27dbda","#9cc8fd","#79b8f7","#afafef","#d580eb","#f74fca","#ea8a1f","#dbdb08","#9cd60d","#f3d335","#c8af41","#00ca69","#24d2b0","#757ebe","#5388db","#e5c5a6","#e93b3b","#f9a2a1","#ed9c65","#e1ca72","#b8da78","#98d52c","#626cbd","#cac8a0","#90d4c2","#ceddfe","#beccf7","#d2d7de","#dadfe4","#e6e9ed","#fe1624","#cd2724","#9ccc65","#009c1b","#ffff00","#beb212","#f5d01d","#e37829"],w=(o.Component,function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={colormap:new Array(a.props.layoutConfig.width).fill(null).map((function(){return new Array(a.props.layoutConfig.height).fill(O[0])}))},a.keypressHistory=void 0,a.currentChain=0,a.midiInputHandler=function(e){console.log(e.data);var t=a.indexOf2dArray(e.data[1],a.props.inputConfig.keymap),n=Object(u.a)(t,2),o=n[0],i=n[1];if(console.log([o,i]),NaN!==o&&NaN!==i)switch(e.data[0]>>4){case 9:if(0!=e.data[2]){a.keyOn(o,i,a.props.inputConfig);break}case 8:a.keyOff(o,i,a.props.inputConfig)}},a.keyOn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.props.layoutConfig,o=void 0;console.log("Note On - "+e.toString()+" "+t.toString());var i=a.arrayCalculation([e,t],n.canvas_origin,"-"),r=Object(u.a)(i,2),s=r[0],l=r[1];if(void 0!==a.props.projectFile){if(void 0!==a.props.projectFile.keySound&&void 0!==a.props.projectFile.keySound[a.currentChain]&&void 0!==a.props.projectFile.keySound[a.currentChain][s]&&void 0!==a.props.projectFile.keySound[a.currentChain][s][l]&&a.props.projectFile.keySound[a.currentChain][s][l].length>0){var c=a.keypressHistory[a.currentChain][e][t]%a.props.projectFile.keySound[a.currentChain][s][l].length;a.props.projectFile.keySound[a.currentChain][s][l][c][0].loop=!1,a.props.projectFile.keySound[a.currentChain][s][l][c][0].stop(),void 0!==a.props.projectFile.keySound[a.currentChain][s][l][c][1]&&(void 0!==a.props.projectFile.keySound[a.currentChain][s][l][c][1][0]&&a.props.projectFile.keySound[a.currentChain][s][l][c][1][0]>1&&(a.props.projectFile.keySound[a.currentChain][s][l][c][0].loop=a.props.projectFile.keySound[a.currentChain][s][l][c][1][0],a.props.projectFile.keySound[a.currentChain][s][l][c][0].onend=function(){this.props.projectFile.keySound[this.currentChain][s][l][c][0].loop--}),void 0!==a.props.projectFile.keySound[a.currentChain][s][l][c][1][1]&&(o=a.props.projectFile.keySound[a.currentChain][s][l][c][1][1])),a.props.projectFile.keySound[a.currentChain][s][l][c][0].play()}if(void 0!==a.props.projectFile.keyLED&&void 0!==a.props.projectFile.keyLED[a.currentChain]&&void 0!==a.props.projectFile.keyLED[a.currentChain][s]&&void 0!==a.props.projectFile.keyLED[a.currentChain][s][l]&&a.props.projectFile.keyLED[a.currentChain][s][l].length>0){var p=a.keypressHistory[a.currentChain][e][t]%a.props.projectFile.keyLED[a.currentChain][s][l].length;a.props.projectFile.keyLED[a.currentChain][s][l][p].play(Object(f.a)(a))}void 0!=a.keypressHistory[a.currentChain][e]&&void 0!=a.keypressHistory[a.currentChain][e][t]&&a.keypressHistory[a.currentChain][e][t]++,void 0===o?a.checkChain(e,t,n):a.chainChange(o)}},a.checkChain=function(e,t,n){for(var o=0;o<n.chainKey.length;o++){if(o===a.props.projectFile.info.chain)return;n.chainKey[o][0]===e&&n.chainKey[o][1]===t&&a.chainChange(o)}},a.keyOff=function(e,t){console.log("Note Off - "+e.toString()+" "+t.toString())},a.chainChange=function(e){console.log("Chain Changed to "+(e+1)),a.currentChain=e},a.setColorPalette=function(e,t,n){var o=a.arrayCalculation([e,t],a.props.layoutConfig.canvas_origin,"+"),i=Object(u.a)(o,2),r=i[0],s=i[1];if(a.state.colormap[r][s]=O[n],void 0!=a.props.outputDevice){var l=a.arrayCalculation([e,t],a.props.outputConfig.canvas_origin,"+"),c=Object(u.a)(l,2),p=c[0],f=c[1];a.sendMidi("NoteOn",a.props.outputConfig.channel,a.props.outputConfig.keymap[f][p],n)}},a.setMCColorPalette=function(e,t){if(null!=a.props.layoutConfig.mcTable[e]){var n=Object(u.a)(a.props.layoutConfig.mcTable[e],2),o=n[0],i=n[1];if(a.state.colormap[o][i]=O[t],void 0!=a.props.outputDevice&&void 0!=a.props.outputConfig.mcTable[e]){var r=Object(u.a)(a.props.outputConfig.mcTable[e],2),s=r[0],l=r[1];a.sendMidi("NoteOn",a.props.outputConfig.channel,a.props.outputConfig.keymap[l][s],t)}}},a.setColorHEX=function(e,t,n){var o=a.arrayCalculation([e,t],a.props.layoutConfig.canvas_origin,"+"),i=Object(u.a)(o,2),r=i[0],s=i[1];a.state.colormap[r][s]=n,a.sendSysex(a.props.outputConfig.hexSysexGen(e,t,n))},a.setMCColorHEX=function(e,t){if(null!=a.props.layoutConfig.mcTable[e]){var n=Object(u.a)(a.props.layoutConfig.mcTable[e],2),o=n[0],i=n[1];a.state.colormap[o][i]=t}null!=a.props.outputConfig.mcTable[e]&&a.sendSysex(a.props.outputConfig.hexSysexGen(e,t))},a.arrayCalculation=function(e,t,n){var a=[];if(e.length===t.length)switch(n){case"+":for(var o=0;o<e.length;o++)a.push(e[o]+t[o]);return a;case"-":for(o=0;o<e.length;o++)a.push(e[o]-t[o]);return a}},setInterval((function(){a.setState({colormap:a.state.colormap})}),1e3/60),a}return Object(p.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.projectFile!==this.props.projectFile&&(console.log("Project File Loaded"),this.initlalizeCanvas(void 0,e.projectFile)),e.layoutConfig!==this.props.layoutConfig&&this.initlalizeCanvas(e.layoutConfig),e.inputDevice!==this.props.inputDevice&&this.setupMidiInput(e.inputDevice,this.props.inputDevice),!0}},{key:"initlalizeCanvas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.layoutConfig,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.projectFile;this.state.colormap=new Array(e.width).fill(null).map((function(){return new Array(e.height).fill(O[0])})),void 0!==t&&(this.keypressHistory=new Array(t.info.chain).fill(null).map((function(){return new Array(e.width).fill(null).map((function(){return new Array(e.height).fill(0)}))}))),this.currentChain=0}},{key:"setupMidiInput",value:function(e,t){void 0!==t&&(t.onmidimessage=null),void 0!==e&&(e.onmidimessage=this.midiInputHandler)}},{key:"sendMidi",value:function(e,t,n,a){if("string"===typeof n){var o=n.charAt(0);switch(n=parseInt(n.substr(1)),o){case"C":e="CC";break;default:return}}switch(e){case"NoteOn":this.props.outputDevice.send([144+t-1,n,a]);break;case"NoteOff":this.props.outputDevice.send([128+t-1,n,a]);break;case"CC":this.props.outputDevice.send([176+t-1,n,a])}}},{key:"sendSysex",value:function(e){this.props.outputDevice.send(e)}},{key:"indexOf2dArray",value:function(e,t){for(var n=0,a=t.length;n<a;n++)for(var o=0,i=t[n].length;o<i;o++)if(t[n][o]===e)return[o,n];return[NaN,NaN]}},{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{children:this.props.layoutConfig.layout.map((function(t,n){return Object(a.jsx)("div",{className:"button-row",children:e.props.layoutConfig.layout[n].map((function(t,o){switch(t){case"\u25fb":return Object(a.jsx)(x,{x:o,y:n,class:"LEDButtonSquare",color:e.state.colormap[o][n],on:e.keyOn,off:e.keyOff});case"\u2b24":return Object(a.jsx)(x,{x:o,y:n,class:"LEDButtonCircle75",color:e.state.colormap[o][n],on:e.keyOn,off:e.keyOff});case"\u25ea":case"\u2b15":case"\u2b14":case"\u25e9":return Object(a.jsx)(x,{x:o,y:n,class:"LEDButtonSquare",color:e.state.colormap[o][n],on:e.keyOn,Zoff:e.keyOff});default:return Object(a.jsx)("div",{style:{width:"96px"}},"Spacer "+o.toString()+"-"+n.toString())}}))})}))})}}]),n}(o.Component)),S={defaultLayout:"Launchpad Pro"},I={"Launchpad Pro":{channel:1,midiNameRegex:"Launchpad Pro",layout:[["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25ea","\u2b15","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u2b14","\u25e9","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u2b24","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u3000","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"]],keymap:[[null,91,92,93,94,95,96,97,98,null],[80,81,82,83,84,85,86,87,88,89],[70,71,72,73,74,75,76,77,78,79],[60,61,62,63,64,65,66,67,68,69],[50,51,52,53,54,55,56,57,58,59],[40,41,42,43,44,45,46,47,48,49],[30,31,32,33,34,35,36,37,38,39],[20,21,22,23,24,25,26,27,28,29],[10,11,12,13,14,15,16,17,18,19],[null,1,2,3,4,5,6,7,8,null]],width:10,height:10,padding:25,radius:15,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],hexSysexGen:function(){if(2==arguments.length||3==arguments.length){switch(arguments.length){case 2:var e=arguments[0];if(null==this.mcTable[e])return;var t=this.mcTable[e],n=arguments[1];break;case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];break;default:return}var o=10*a+t,i=n>>16>>2,r=(255&n)>>2,s=(255&n)>>2;return[240,0,32,41,2,24,11,o,i,r,s,247]}}},"Launchpad Pro (CFW)":{channel:16,midiNameRegex:"Launchpad Open",keymap:[[null,28,29,30,31,32,33,34,35,null],[108,64,65,66,67,96,97,98,99,100],[109,60,61,62,63,92,93,94,95,101],[110,56,57,58,59,88,89,90,91,102],[111,52,53,54,55,84,85,86,87,103],[112,48,49,50,51,80,81,82,83,104],[113,44,45,46,47,76,77,78,79,105],[114,40,41,42,43,72,73,74,75,106],[115,36,37,38,39,68,69,70,71,107],[null,116,117,118,119,120,121,122,123,null]],width:10,height:10,padding:25,radius:15,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],hexSysexGen:function(){if(2==arguments.length||3==arguments.length){switch(arguments.length){case 2:var e=arguments[0];if(null==this.mcTable[e])return;var t=this.mcTable[e],n=arguments[1];break;case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];break;default:return}var o=10*a+t,i=n>>16>>2,r=(255&n)>>2,s=(255&n)>>2;return[240,0,32,41,2,24,11,o,i,r,s,247]}}},"Launchpad MK2":{channel:1,midiNameRegex:"^Launchpad MK2",layout:[["\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u2b24","\u3000"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25ea","\u2b15","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u2b14","\u25e9","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u2b24"]],keymap:[["C104","C105","C106","C107","C108","C109","C110","C111",null],[81,82,83,84,85,86,87,88,89],[71,72,73,74,75,76,77,78,79],[61,62,63,64,65,66,67,68,69],[51,52,53,54,55,56,57,58,59],[41,42,43,44,45,46,47,48,49],[31,32,33,34,35,36,37,38,39],[21,22,23,24,25,26,27,28,29],[11,12,13,14,15,16,17,18,19]],width:9,height:9,padding:25,radius:15,canvas_origin:[0,1],chainKey:[[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8]],mcTable:[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],hexSysexGen:function(){if(2==arguments.length||3==arguments.length)switch(arguments.length){case 2:var e=arguments[0];if(null==this.mcTable[e])return;var t=this.mcTable[e],n=arguments[1];case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];default:var o=10*a+t,i=n>>16>>2,r=(255&n)>>2,s=(255&n)>>2;return[240,0,32,41,2,24,11,o,i,r,s,247]}}},"Launchpad X":{channel:1,midiNameRegex:"^Launchpad X",keymap:[[28,29,30,31,32,33,34,35,27],[64,65,66,67,96,97,98,99,100],[60,61,62,63,92,93,94,95,101],[56,57,58,59,88,89,90,91,102],[52,53,54,55,84,85,86,87,103],[48,49,50,51,80,81,82,83,104],[44,45,46,47,76,77,78,79,105],[40,41,42,43,72,73,74,75,106],[36,37,38,39,68,69,70,71,107]],width:9,height:9,padding:25,radius:5,canvas_origin:[0,1],chainKey:[[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8]],mcTable:[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],hexSysexGen:function(){if(2==arguments.length||3==arguments.length){switch(arguments.length){case 2:var e=arguments[0];if(null==this.mcTable[e])return;var t=this.mcTable[e],n=arguments[1];break;case 3:var a=arguments[0]+1;t=arguments[1]+1,n=arguments[2];break;default:return}var o=10*a+t,i=n>>16>>1,r=(255&n)>>1,s=(255&n)>>1;return[240,0,32,41,2,12,22,3,3,o,i,r,s,247]}}},"Launchpad Pro MK3":{channel:1,midiNameRegex:"^Launchpad Pro MK3",keymap:[[26,28,29,30,31,32,33,34,35,27],[108,64,65,66,67,96,97,98,99,100],[109,60,61,62,63,92,93,94,95,101],[110,56,57,58,59,88,89,90,91,102],[111,52,53,54,55,84,85,86,87,103],[112,48,49,50,51,80,81,82,83,104],[113,44,45,46,47,76,77,78,79,105],[114,40,41,42,43,72,73,74,75,106],[115,36,37,38,39,68,69,70,71,107],[null,116,117,118,119,120,121,122,123,null]],width:10,height:10,padding:25,radius:5,canvas_origin:[1,1],chainKey:[[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8]],mcTable:[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],[9,8],[8,9],[7,9],[6,9],[5,9],[4,9],[3,9],[2,9],[1,9],[0,8],[0,7],[0,6],[0,5],[0,4],[0,3],[0,2],[0,1]],hexSysexGen:function(){}},Matrix:{channel:2,midiNameRegex:"^Matrix",layout:[["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25ea","\u2b15","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u2b14","\u25e9","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"],["\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb","\u25fb"]],keymap:[[64,65,66,67,96,97,98,99],[60,61,62,63,92,93,94,95],[56,57,58,59,88,89,90,91],[52,53,54,55,84,85,86,87],[48,49,50,51,80,81,82,83],[44,45,46,47,76,77,78,79],[40,41,42,43,72,73,74,75],[36,37,38,39,68,69,70,71],[100,101,102,103,104,105,106,107]],width:8,height:8,padding:20,radius:15,canvas_origin:[0,0],chainKey:[[0,8],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8]],mcTable:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],hexSysexGen:function(){if(3==arguments.length){switch(arguments.length){case 3:var e=arguments[2];break;default:return}var t=e>>16>>1,n=(255&e)>>1,a=(255&e)>>1;return[240,0,2,3,1,0,18,32,0,3,t,n,a,247]}}}},D=n(16),F=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).state={projectFile:void 0,midiInput:[],midiOutput:[],layoutConfigName:S.defaultLayout,layoutConfig:I[S.defaultLayout],inputDevice:void 0,inputConfigName:void 0,inputConfig:void 0,outputDevice:void 0,outputConfigName:void 0,outputConfig:void 0,autoplayProgress:void 0},a.canvas=i.a.createRef(),a.downloadProjectFile=function(e){},a.loadProjectFile=function(e){new k(e).then((function(e){a.setState({projectFile:e}),console.log(e)})).catch((function(e){alert(e)}))},a.onMIDISuccess=function(e){console.log("Got access your MIDI devices.");var t=[];console.log("Input");var n,o=Object(l.a)(e.inputs.values());try{for(o.s();!(n=o.n()).done;){var i=n.value;console.log(i.name),t.push({label:i.name,value:i})}}catch(p){o.e(p)}finally{o.f()}console.log(t),a.setState({midiInput:t});var r=[];console.log(),console.log("Output");var s,u=Object(l.a)(e.outputs.values());try{for(u.s();!(s=u.n()).done;){var c=s.value;console.log(c.name),r.push({label:c.name,value:c})}}catch(p){u.e(p)}finally{u.f()}a.setState({midiOutput:r})},a.playAutoplay=function(){void 0!==a.state.projectFile&&void 0!==a.state.projectFile.autoplay?a.state.projectFile.autoplay.play(a.canvas.current,a.state.layoutConfig.canvas_origin,function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];this.setState({autoplayProgress:" - ".concat((n/a*100).toFixed(2),"% completed (").concat(n,"/").concat(a,")")})}.bind(Object(f.a)(a))):alert("No project loaded!")},a.stopAutoplay=function(){void 0!==a.state.projectFile&&void 0!==a.state.projectFile.autoplay?(a.state.projectFile.autoplay.stop(),a.setState({autoplayProgress:void 0})):alert("No project loaded!")},a.pauseAutoplay=function(){void 0!==a.state.projectFile&&void 0!==a.state.projectFile.autoplay?(a.state.projectFile.autoplay.pause(),a.setState({autoplayProgress:a.state.autoplayProgress+" - Paused"})):alert("No project loaded!")},void 0!=navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(a.onMIDISuccess,a.onMIDIFailure):alert("Your device doesn't support WebMidi");var o=new URLSearchParams(window.location.search);if(o.get("unipack")){var r=o.get("unipack");a.downloadProjectFile(r)}return a}return Object(p.a)(n,[{key:"onMidiStateChange",value:function(e){if(console.log(e),console.log(e.port.name,e.port.state),"connected"===e.port.state){if("input"===e.port.type)(t=this.state.midiInput).push({label:e.port.name,value:e.port}),this.setState({midiInput:t});else if("output"===e.port.type){(a=this.state.midiOutput).push({label:e.port.name,value:e.port}),this.setState({midiOutput:a})}}else if("disconnected"===e.port.state)if("input"===e.port.type){for(var t=this.state.midiInput,n=0;n<t.length;n++)if(t[n].label===e.port.name){t.splice(n);break}this.setState({midiInput:t}),this.state.inputDevice.name===this.e.port.name&&(this.setState({inputDevice:void 0}),this.setState({inputDeviceConfig:void 0}),this.setState({inputDeviceName:void 0}))}else if("output"===e.port.type){var a=this.state.midiOutput;for(n=0;n<a.length;n++)if(a[n].label===e.port.name){a.splice(n);break}this.setState({midiOutput:a}),this.state.outputDevice.name===this.e.port.name&&(this.setState({outputDevice:void 0}),this.setState({outputDeviceConfig:void 0}),this.setState({outputDeviceName:void 0}))}}},{key:"onMIDIFailure",value:function(){console.log("Could not access your MIDI devices."),alert("Could not access your MIDI devices. Try use another web browser or hardware platform")}},{key:"autoConfigPicker",value:function(e,t){if(void 0!==e)for(var n in I)if(null!==e.match(I[n].midiNameRegex)){var a=I[n];switch(console.log("".concat(t?"Output":"input"," config has been auto assigned to ").concat(n)),t){case 0:return this.setState({inputConfigName:n}),void this.setState({inputConfig:a});case 1:return this.setState({outputConfigName:n}),void this.setState({outputConfig:a})}}alert("Unable to find matching ".concat(t?"output":"input"," config for device ").concat(e))}},{key:"render",value:function(){return Object(a.jsx)(i.a.Fragment,{children:Object(a.jsxs)("div",{className:"main",children:[Object(a.jsxs)("div",{className:"toolbar",children:[" ",Object(a.jsx)("text",{children:"203 | Prismatic (Tech Preview Demo)"}),Object(a.jsx)("div",{className:"toolbarItem"}),Object(a.jsx)("text",{className:"toolbarItem",children:void 0!==this.state.projectFile?"Current Project: ".concat(this.state.projectFile.info.title," by ").concat(this.state.projectFile.info.producerName):"No project loaded"}),Object(a.jsx)(v,{loadProjectFile:this.loadProjectFile}),Object(a.jsx)("div",{className:"toolbarItem"}),Object(a.jsx)("text",{children:"UI Layout"}),Object(a.jsx)(D.a,{className:"toolbarItem",options:this.prepDeviceConfig("layout"),autosize:!0,value:void 0!==this.state.layoutConfigName?{label:this.state.layoutConfigName,value:this.state.layoutConfig}:void 0,placeholder:"Layout Config",onChange:this.setLayoutConfig.bind(this)}),Object(a.jsx)("text",{children:"Midi Input Device"}),Object(a.jsx)(D.a,{className:"toolbarItem",options:this.state.midiInput,autosize:!0,value:void 0!==this.state.inputDevice?{label:this.state.inputDevice.name,value:this.state.inputDevice}:void 0,placeholder:"Input Device",onChange:this.setInputDevice.bind(this)}),Object(a.jsx)("text",{children:"Midi Input Device Config"}),Object(a.jsx)(D.a,{className:"toolbarItem",options:this.prepDeviceConfig("control"),autosize:!0,value:void 0!==this.state.inputConfigName?{label:this.state.inputConfigName,value:this.state.inputConfig}:void 0,placeholder:"Input Device Config",onChange:this.setInputConfig.bind(this)}),Object(a.jsx)("text",{children:"Midi Output Device"}),Object(a.jsx)(D.a,{className:"toolbarItem",options:this.state.midiOutput,autosize:!0,value:void 0!==this.state.outputDevice?{label:this.state.outputDevice.name,value:this.state.outputDevice}:void 0,placeholder:"Output Device",onChange:this.setOutputDevice.bind(this)}),Object(a.jsx)("text",{children:"Midi Output Device Config"}),Object(a.jsx)(D.a,{className:"toolbarItem",options:this.prepDeviceConfig("control"),autosize:!0,value:void 0!==this.state.outputConfigName?{label:this.state.outputConfigName,value:this.state.outputConfig}:void 0,placeholder:"Output Device Config",onChange:this.setOutputConfig.bind(this)}),Object(a.jsx)("div",{}),Object(a.jsx)("text",{children:"Autoplay"+(void 0===this.state.autoplayProgress?"":this.state.autoplayProgress)}),Object(a.jsx)("div",{}),Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px",display:void 0===this.state.projectFile||"PLAYING"!==this.state.projectFile.autoplay.status?"inline":"none"},onClick:this.playAutoplay,children:"Play"}),Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px",display:void 0!==this.state.projectFile&&"PAUSED"===this.state.projectFile.autoplay.status?"inline":"none"},onClick:this.stopAutoplay,children:"Stop"}),Object(a.jsx)("button",{style:{width:"50px",marginRight:"10px",display:void 0!==this.state.projectFile&&"PLAYING"===this.state.projectFile.autoplay.status?"inline":"none"},onClick:this.pauseAutoplay,children:"Pause"})]}),Object(a.jsx)("div",{className:"canvas",style:{padding:this.state.layoutConfig.padding,borderRadius:this.state.layoutConfig.radius},children:Object(a.jsx)(w,{ref:this.canvas,projectFile:this.state.projectFile,layoutConfig:this.state.layoutConfig,inputDevice:this.state.inputDevice,inputConfig:this.state.inputConfig,outputDevice:this.state.outputDevice,outputConfig:this.state.outputConfig})})]})})}},{key:"setLayoutConfig",value:function(e){this.setState({layoutConfigName:e.label}),this.setState({layoutConfig:e.value})}},{key:"setInputConfig",value:function(e){this.setState({inputConfigName:e.label}),this.setState({inputConfig:e.value})}},{key:"setOutputConfig",value:function(e){this.setState({outputConfigName:e.label}),this.setState({outputConfig:e.value})}},{key:"setInputDevice",value:function(e){this.setState({inputDevice:e.value}),this.autoConfigPicker(e.value.name,0)}},{key:"setOutputDevice",value:function(e){this.setState({outputDevice:e.value}),this.autoConfigPicker(e.value.name,1)}},{key:"prepDeviceConfig",value:function(e){var t=[];for(var n in I)("layout"===e&&void 0!==I[n].layout||"control"===e&&void 0!==I[n].keymap)&&t.push({label:n,value:I[n]});return t}}]),n}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(a.jsx)(F,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.e28fc481.chunk.js.map